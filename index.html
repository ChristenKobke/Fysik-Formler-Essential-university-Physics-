<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Physics Formulas - Complete Reference</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"></script>
    
    <style>
        :root {
            --bg:#faf8f3; --fg:#3d3428; --sb:#f5f2ed; --bdr:#e8dfd0; --acc:#a67c52; 
            --hov:#e8e5df; --fb:#ffffff; --fbdr:#8b9b7e; --fn-bg:rgba(139,155,126,.08); 
            --fn-fg:#8b9b7e; --hl:#fff9e6; --hdr1:#3d3428; --hdr2:#6b5d4f; --hdr-fg:#f4f1ea;
            --c1:#9b59b6; --c2:#3498db; --c3:#1abc9c; --c4:#e74c3c; --c5:#f39c12; --c6:#e67e22; --c7:#2ecc71;
        }
        body.dark {
            --bg:#272822; --fg:#f8f8f2; --sb:#1e1f1c; --bdr:#3e3d32; --acc:#e6db74; 
            --hov:#3e3d32; --fb:#2d2e27; --fbdr:#66d9ef; --fn-bg:rgba(166,226,46,.15); 
            --fn-fg:#a6e22e; --hl:#49483e; --hdr1:#1e1f1c; --hdr2:#2d2e27;
        }
        body.dracula {
            --bg:#282a36; --fg:#f8f8f2; --sb:#21222c; --bdr:#44475a; --acc:#ff79c6; 
            --hov:#44475a; --fb:#2c2d3a; --fbdr:#8be9fd; --fn-bg:rgba(139,233,253,.15); 
            --fn-fg:#8be9fd; --hl:#44475a; --hdr1:#21222c; --hdr2:#2c2d3a;
        }
        body.nord {
            --bg:#2e3440; --fg:#eceff4; --sb:#242933; --bdr:#3b4252; --acc:#88c0d0; 
            --hov:#3b4252; --fb:#3b4252; --fbdr:#81a1c1; --fn-bg:rgba(136,192,208,.15); 
            --fn-fg:#88c0d0; --hl:#434c5e; --hdr1:#242933; --hdr2:#2e3440;
        }
        body.gruvbox {
            --bg:#282828; --fg:#ebdbb2; --sb:#1d2021; --bdr:#3c3836; --acc:#fabd2f; 
            --hov:#3c3836; --fb:#3c3836; --fbdr:#b8bb26; --fn-bg:rgba(184,187,38,.15); 
            --fn-fg:#b8bb26; --hl:#504945; --hdr1:#1d2021; --hdr2:#282828;
        }
        body.synthwave {
            --bg:#262335; --fg:#f92aad; --sb:#1c1826; --bdr:#382c4a; --acc:#fede5d; 
            --hov:#382c4a; --fb:#2d2437; --fbdr:#36f9f6; --fn-bg:rgba(54,249,246,.15); 
            --fn-fg:#36f9f6; --hl:#382c4a; --hdr1:#1c1826; --hdr2:#241b2f; --hdr-fg:#fede5d;
        }
        body.ocean {
            --bg:#1b2b34; --fg:#c0c5ce; --sb:#0f1419; --bdr:#343d46; --acc:#6699cc; 
            --hov:#343d46; --fb:#343d46; --fbdr:#5fb3b3; --fn-bg:rgba(95,179,179,.15); 
            --fn-fg:#5fb3b3; --hl:#4f5b66; --hdr1:#0f1419; --hdr2:#1b2b34;
        }
        body.solarized {
            --bg:#fdf6e3; --fg:#657b83; --sb:#eee8d5; --bdr:#d9d2c3; --acc:#268bd2; 
            --hov:#e8e5df; --fb:#fff; --fbdr:#859900; --fn-bg:rgba(38,139,210,.1); 
            --fn-fg:#268bd2; --hl:#ece3c8; --hdr1:#eee8d5; --hdr2:#e3dcc3; --hdr-fg:#586e75;
        }
        body.monokai {
            --bg:#272822; --fg:#f8f8f2; --sb:#1e1f1c; --bdr:#49483e; --acc:#66d9ef; 
            --hov:#3e3d32; --fb:#2d2e27; --fbdr:#a6e22e; --fn-bg:rgba(249,38,114,.15); 
            --fn-fg:#f92672; --hl:#49483e; --hdr1:#1e1f1c; --hdr2:#2d2e27;
        }
        body.forest {
            --bg:#1a2421; --fg:#d4e7d4; --sb:#0f1612; --bdr:#2d4a39; --acc:#7cb668; 
            --hov:#263832; --fb:#1e2d26; --fbdr:#5a8a4d; --fn-bg:rgba(124,182,104,.15); 
            --fn-fg:#7cb668; --hl:#2d4a39; --hdr1:#0f1612; --hdr2:#1a2421;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; font-size: 14px;
            line-height: 1.6; background: var(--bg); color: var(--fg); transition: all 0.3s; }
        .container { display: grid; grid-template-columns: 280px 1fr; min-height: 100vh; max-width: 1800px; margin: 0 auto; }
        
        /* Sidebar */
        .sidebar { background: var(--sb); border-right: 1px solid var(--bdr); position: sticky; top: 0;
            height: 100vh; overflow-y: auto; overflow-x: hidden; }
        .sidebar-header { padding: 16px; background: linear-gradient(135deg, var(--hdr1), var(--hdr2));
            color: var(--hdr-fg); position: sticky; top: 0; z-index: 10; border-bottom: 2px solid var(--acc); }
        .sidebar-header h1 { font-size: 15px; font-weight: 600; margin-bottom: 4px; }
        .sidebar-header p { font-size: 11px; opacity: 0.85; margin-bottom: 8px; }
        
        /* Theme Selector */
        .theme-selector { position: relative; }
        .theme-btn { width: 100%; padding: 6px 10px; background: rgba(255,255,255,0.1); 
            border: 1px solid rgba(255,255,255,0.2); color: var(--hdr-fg); cursor: pointer;
            border-radius: 4px; font-size: 11px; display: flex; justify-content: space-between; align-items: center; }
        .theme-btn:hover { background: rgba(255,255,255,0.2); }
        .theme-menu { display: none; position: absolute; top: 100%; left: 0; right: 0; margin-top: 4px;
            background: var(--fb); border: 1px solid var(--bdr); border-radius: 4px; max-height: 300px;
            overflow-y: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 100; }
        .theme-menu.show { display: block; }
        .theme-opt { padding: 8px 12px; cursor: pointer; font-size: 11px; color: var(--fg);
            transition: 0.2s; border-left: 3px solid transparent; }
        .theme-opt:hover { background: var(--hov); border-left-color: var(--acc); }
        .theme-opt.active { background: var(--acc); color: var(--bg); font-weight: 600; }
        
        /* Navigation */
        .nav-part { margin: 8px 0; }
        .part-header { padding: 8px 12px; cursor: pointer; font-size: 11px; font-weight: 600;
            text-transform: uppercase; letter-spacing: 0.5px; border-left: 4px solid;
            transition: 0.2s; display: flex; justify-content: space-between; align-items: center; }
        .part-header:hover { background: var(--hov); }
        .part-header.p0 { border-left-color: var(--c1); color: var(--c1); }
        .part-header.p1 { border-left-color: var(--c2); color: var(--c2); }
        .part-header.p2 { border-left-color: var(--c3); color: var(--c3); }
        .part-header.p3 { border-left-color: var(--c4); color: var(--c4); }
        .part-header.p4 { border-left-color: var(--c5); color: var(--c5); }
        .part-header.p5 { border-left-color: var(--c6); color: var(--c6); }
        .part-header.p6 { border-left-color: var(--c7); color: var(--c7); }
        .part-chapters { max-height: 0; overflow: hidden; transition: max-height 0.3s; }
        .nav-part.open .part-chapters { max-height: 1000px; }
        .nav-part.open .arrow { transform: rotate(90deg); }
        .arrow { transition: transform 0.3s; font-size: 10px; }
        .chapter-link { padding: 6px 12px 6px 20px; font-size: 11px; cursor: pointer;
            transition: 0.2s; border-left: 3px solid transparent; color: var(--fg); opacity: 0.7; }
        .chapter-link:hover { background: var(--hov); opacity: 1; border-left-color: var(--acc); }
        .chapter-link.active { background: var(--hov); font-weight: 600; opacity: 1; border-left-color: var(--acc); }
        
        /* Main Content */
        .main-content { padding: 24px; max-width: 1200px; }
        .search-box { position: sticky; top: 0; background: var(--bg); padding: 16px 0;
            margin-bottom: 24px; z-index: 5; border-bottom: 1px solid var(--bdr); }
        .search-input { width: 100%; padding: 10px 14px; border: 2px solid var(--bdr);
            border-radius: 6px; font-size: 14px; background: var(--fb); color: var(--fg);
            outline: none; transition: 0.2s; }
        .search-input:focus { border-color: var(--acc); box-shadow: 0 0 0 3px rgba(166, 124, 82, 0.1); }
        .search-status { font-size: 12px; color: var(--fg); opacity: 0.6; margin-top: 6px; text-align: center; }
        
        /* Formula Cards */
        .chapter-section { margin-bottom: 48px; scroll-margin-top: 80px; }
        .chapter-title { font-size: 24px; font-weight: 700; margin-bottom: 20px; padding-bottom: 10px;
            border-bottom: 3px solid var(--acc); color: var(--fg); }
        .formulas-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 16px; }
        .formula-card { background: var(--fb); border: 1px solid var(--bdr); border-left: 3px solid var(--fbdr);
            border-radius: 8px; padding: 16px; transition: 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .formula-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: var(--acc); }
        .formula-card.highlight { background: var(--hl); border-color: var(--acc);
            box-shadow: 0 0 0 2px rgba(166, 124, 82, 0.2); }
        .formula-number { display: inline-block; font-size: 10px; font-weight: 700; color: var(--fn-fg);
            background: var(--fn-bg); padding: 3px 8px; border-radius: 4px; margin-bottom: 10px;
            text-transform: uppercase; letter-spacing: 0.5px; }
        .formula-content { text-align: center; padding: 14px 0; min-height: 60px;
            display: flex; align-items: center; justify-content: center; }
        .katex { font-size: 1.2em !important; color: var(--fg) !important; }
        .formula-desc { font-size: 12px; color: var(--fg); opacity: 0.75; font-style: italic;
            margin-top: 10px; padding-top: 10px; border-top: 1px dashed var(--bdr); text-align: center; }
        
        /* Mobile */
        .mobile-menu-btn { display: none; }
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
            .sidebar { position: fixed; left: -280px; z-index: 100; transition: left 0.3s; }
            .sidebar.open { left: 0; }
            .formulas-grid { grid-template-columns: 1fr; }
            .mobile-menu-btn { display: block; position: fixed; top: 16px; left: 16px; z-index: 101;
                background: var(--acc); color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; }
        }
        
        /* Scrollbar */
        .sidebar::-webkit-scrollbar { width: 6px; }
        .sidebar::-webkit-scrollbar-track { background: var(--sb); }
        .sidebar::-webkit-scrollbar-thumb { background: var(--bdr); border-radius: 3px; }
        .sidebar::-webkit-scrollbar-thumb:hover { background: var(--acc); }
    </style>
</head>
<body>

<button class="mobile-menu-btn" onclick="toggleSidebar()">☰ Menu</button>

<div class="container">
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h1>Physics Formulas</h1>
            <p>Complete Reference Ch.1-39</p>
            <div class="theme-selector">
                <button class="theme-btn" onclick="toggleThemeMenu()">
                    <span id="currentTheme">Default</span>
                    <span>▾</span>
                </button>
                <div class="theme-menu" id="themeMenu"></div>
            </div>
        </div>
        <nav id="navigation"></nav>
    </aside>
    
    <main class="main-content">
        <div class="search-box">
            <input type="text" class="search-input" id="searchInput" placeholder="Search formulas, equations, or concepts...">
            <div class="search-status" id="searchStatus"></div>
        </div>
        <div id="content"></div>
    </main>
</div>

<script>
const FORMULA_DATA = {
    "Ch.1: Doing Physics": [
        { id: "Prob.69", formula: `V = \\frac{4}{3}\\pi r^3`, desc: "Volume of Sphere" }
    ],
    "Ch.2: Motion in Straight Line": [
        { id: "2.1", formula: `\\bar{v} = \\frac{\\Delta x}{\\Delta t}`, desc: "Average Velocity" },
        { id: "2.2b", formula: `v = \\frac{dx}{dt}`, desc: "Instantaneous Velocity" },
        { id: "2.4", formula: `\\bar{a} = \\frac{\\Delta v}{\\Delta t}`, desc: "Average Acceleration" },
        { id: "2.5", formula: `a = \\frac{dv}{dt}`, desc: "Instantaneous Acceleration" },
        { id: "2.7", formula: `v = v_0 + at`, desc: "Velocity (Const. Accel.)" },
        { id: "2.10", formula: `x = x_0 + v_0t + \\frac{1}{2}at^2`, desc: "Position vs Time" },
        { id: "2.11", formula: `v^2 = v_0^2 + 2a(x - x_0)`, desc: "Velocity vs Position" }
    ],
    "Ch.3: Motion in 2D/3D": [
        { id: "3.1", formula: `A = \\sqrt{A_x^2 + A_y^2}`, desc: "Vector Magnitude" },
        { id: "3.2", formula: `A_x = A \\cos\\theta; A_y = A \\sin\\theta`, desc: "Vector Components" },
        { id: "3.7", formula: `\\mathbf{v} = \\mathbf{v'} + \\mathbf{V}`, desc: "Relative Velocity" },
        { id: "3.9", formula: `\\mathbf{r} = \\mathbf{r}_0 + \\mathbf{v}_0t + \\frac{1}{2}\\mathbf{a}t^2`, desc: "Position Vector (Const. Accel.)" },
        { id: "3.15", formula: `R = \\frac{v_0^2}{g} \\sin(2\\theta_0)`, desc: "Horizontal Range" },
        { id: "3.16", formula: `a_c = \\frac{v^2}{r}`, desc: "Centripetal Acceleration" }
    ],
    "Ch.4: Force & Motion": [
        { id: "4.2", formula: `\\mathbf{F}_{net} = \\frac{d\\mathbf{p}}{dt}`, desc: "Newton's 2nd Law (General)" },
        { id: "4.3", formula: `\\mathbf{F}_{net} = m\\mathbf{a}`, desc: "Newton's 2nd Law (Const. Mass)" },
        { id: "4.5", formula: `\\mathbf{w} = m\\mathbf{g}`, desc: "Weight" },
        { id: "4.9", formula: `F_s = -kx`, desc: "Hooke's Law" }
    ],
    "Ch.5: Using Newton's Laws": [
        { id: "5.1", formula: `F_{net} = \\frac{mv^2}{r}`, desc: "Net Force (Circular Motion)" },
        { id: "5.2", formula: `f_s \\le \\mu_s n`, desc: "Static Friction" },
        { id: "5.3", formula: `f_k = \\mu_k n`, desc: "Kinetic Friction" }
    ],
    "Ch.6: Energy, Work, Power": [
        { id: "6.5", formula: `W = \\mathbf{F} \\cdot \\Delta\\mathbf{r}`, desc: "Work (Scalar Product)" },
        { id: "6.13", formula: `K = \\frac{1}{2}mv^2`, desc: "Kinetic Energy" },
        { id: "6.14", formula: `\\Delta K = W_{net}`, desc: "Work-KE Theorem" },
        { id: "6.19", formula: `P = \\mathbf{F} \\cdot \\mathbf{v}`, desc: "Power" }
    ],
    "Ch.7: Conservation of Energy": [
        { id: "7.3", formula: `\\Delta U_g = mg\\Delta y`, desc: "Gravitational PE Change" },
        { id: "7.4", formula: `U_s = \\frac{1}{2}kx^2`, desc: "Elastic PE" },
        { id: "7.6", formula: `K_i + U_i = K_f + U_f`, desc: "Mechanical Energy Conservation" },
        { id: "7.9", formula: `F_x = -\\frac{dU}{dx}`, desc: "Force from PE" }
    ],
    "Ch.8: Gravity": [
        { id: "8.1", formula: `F_g = G\\frac{m_1m_2}{r^2}`, desc: "Universal Gravitation" },
        { id: "8.3", formula: `v = \\sqrt{\\frac{GM}{r}}`, desc: "Speed (Circular Orbit)" },
        { id: "8.6", formula: `U(r) = -\\frac{GMm}{r}`, desc: "Gravitational PE" },
        { id: "8.7", formula: `v_{esc} = \\sqrt{\\frac{2GM}{r}}`, desc: "Escape Speed" }
    ],
    "Ch.9: Systems of Particles": [
        { id: "9.2", formula: `\\mathbf{r}_{cm} = \\frac{\\sum m_i\\mathbf{r}_i}{M}`, desc: "Center of Mass" },
        { id: "9.7", formula: `\\mathbf{P}_{initial} = \\mathbf{P}_{final}`, desc: "Momentum Conservation" },
        { id: "9.10b", formula: `\\mathbf{J} = \\int \\mathbf{F}(t) dt = \\Delta\\mathbf{p}`, desc: "Impulse" }
    ],
    "Ch.10: Rotational Motion": [
        { id: "10.3", formula: `v_t = \\omega r`, desc: "Tangential Speed" },
        { id: "10.11", formula: `\\tau = I\\alpha`, desc: "Rotational Newton's 2nd Law" },
        { id: "10.12", formula: `I = \\sum m_i r_i^2`, desc: "Rotational Inertia" },
        { id: "10.18", formula: `K_{rot} = \\frac{1}{2}I\\omega^2`, desc: "Rotational KE" }
    ],
    "Ch.11: Angular Momentum": [
        { id: "11.3", formula: `\\mathbf{L} = \\mathbf{r} \\times \\mathbf{p}`, desc: "Angular Momentum (Particle)" },
        { id: "11.4", formula: `\\mathbf{L} = I\\boldsymbol{\\omega}`, desc: "Angular Momentum (Rigid Body)" },
        { id: "11.5", formula: `\\frac{d\\mathbf{L}}{dt} = \\boldsymbol{\\tau}`, desc: "Rotational Newton's 2nd Law" }
    ],
    "Ch.12: Static Equilibrium": [
        { id: "12.1", formula: `\\sum \\mathbf{F}_i = 0`, desc: "Force Balance" },
        { id: "12.2", formula: `\\sum \\boldsymbol{\\tau}_i = 0`, desc: "Torque Balance" }
    ],
    "Ch.13: Oscillatory Motion": [
        { id: "13.7b", formula: `T = 2\\pi\\sqrt{\\frac{m}{k}}`, desc: "Period (Mass-Spring)" },
        { id: "13.8", formula: `x(t) = A \\cos(\\omega t + \\phi)`, desc: "Position (SHM General)" },
        { id: "13.15", formula: `T = 2\\pi\\sqrt{\\frac{L}{g}}`, desc: "Period (Simple Pendulum)" }
    ],
    "Ch.14: Wave Motion": [
        { id: "14.1", formula: `v = f\\lambda`, desc: "Wave Speed" },
        { id: "14.3", formula: `y(x,t) = A \\cos(kx - \\omega t)`, desc: "Sinusoidal Wave" },
        { id: "14.6", formula: `v = \\sqrt{\\frac{F_T}{\\mu}}`, desc: "Wave Speed (String)" },
        { id: "14.15", formula: `f' = f\\left(\\frac{v}{v \\mp u_s}\\right)`, desc: "Doppler (Moving Source)" }
    ],
    "Ch.15: Fluid Motion": [
        { id: "15.3", formula: `p = p_0 + \\rho gh`, desc: "Pressure in a Liquid" },
        { id: "15.4", formula: `A_1 v_1 = A_2 v_2`, desc: "Continuity Equation" },
        { id: "15.6", formula: `p + \\frac{1}{2}\\rho v^2 + \\rho gy = \\text{const}`, desc: "Bernoulli's Equation" }
    ],
    "Ch.16: Temperature & Heat": [
        { id: "16.3", formula: `Q = mc\\Delta T`, desc: "Specific Heat" },
        { id: "16.5", formula: `H = -kA\\frac{\\Delta T}{\\Delta x}`, desc: "Conductive Heat Flow" },
        { id: "16.9", formula: `P = e\\sigma AT^4`, desc: "Stefan-Boltzmann Law" }
    ],
    "Ch.17: Thermal Behavior": [
        { id: "17.2", formula: `PV = nRT`, desc: "Ideal-Gas Law (moles)" },
        { id: "17.3", formula: `\\bar{K} = \\frac{3}{2}kT`, desc: "Avg Molecular KE" },
        { id: "17.5", formula: `Q = Lm`, desc: "Heat of Transformation" }
    ],
    "Ch.18: First Law of Thermo": [
        { id: "18.1", formula: `\\Delta E_{int} = Q + W`, desc: "First Law of Thermodynamics" },
        { id: "18.3", formula: `W = -\\int p dV`, desc: "Work on Gas" },
        { id: "18.9", formula: `C_p = C_V + R`, desc: "Molar Specific Heats" },
        { id: "18.11a", formula: `pV^{\\gamma} = \\text{const}`, desc: "Adiabatic Process" }
    ],
    "Ch.19: Second Law of Thermo": [
        { id: "19.1", formula: `e = \\frac{W}{Q_h} = 1 - \\frac{Q_c}{Q_h}`, desc: "Heat Engine Efficiency" },
        { id: "19.3", formula: `e_C = 1 - \\frac{T_c}{T_h}`, desc: "Carnot Efficiency" },
        { id: "19.6", formula: `\\Delta S = \\int \\frac{dQ}{T}`, desc: "Entropy Change" }
    ],
    "Ch.20: Electric Fields": [
        { id: "20.1", formula: `F = k\\frac{|q_1 q_2|}{r^2}`, desc: "Coulomb's Law" },
        { id: "20.2a", formula: `\\mathbf{E} = \\frac{\\mathbf{F}}{q}`, desc: "Electric Field Definition" },
        { id: "20.3", formula: `E = k\\frac{|q|}{r^2}`, desc: "Field of Point Charge" }
    ],
    "Ch.21: Gauss's Law": [
        { id: "21.3", formula: `\\oint \\mathbf{E} \\cdot d\\mathbf{A} = \\frac{q_{enc}}{\\epsilon_0}`, desc: "Gauss's Law" },
        { id: "21.6", formula: `E = \\frac{\\lambda}{2\\pi\\epsilon_0 r}`, desc: "Field of Line Charge" },
        { id: "21.7", formula: `E = \\frac{\\sigma}{2\\epsilon_0}`, desc: "Field of Charged Sheet" }
    ],
    "Ch.22: Electric Potential": [
        { id: "22.1a", formula: `\\Delta V = -\\int_A^B \\mathbf{E} \\cdot d\\mathbf{r}`, desc: "Potential Difference" },
        { id: "22.3", formula: `V(r) = k\\frac{q}{r}`, desc: "Point-Charge Potential" },
        { id: "22.9", formula: `\\mathbf{E} = -\\nabla V`, desc: "Field from Potential" }
    ],
    "Ch.23: Capacitors": [
        { id: "23.1", formula: `C = \\frac{Q}{V}`, desc: "Capacitance" },
        { id: "23.2", formula: `C = \\frac{\\epsilon_0 A}{d}`, desc: "Parallel-Plate Capacitor" },
        { id: "23.3", formula: `U = \\frac{1}{2}CV^2`, desc: "Energy in Capacitor" }
    ],
    "Ch.24: Electric Current": [
        { id: "24.5", formula: `V=IR`, desc: "Ohm's Law" },
        { id: "24.6", formula: `R = \\rho\\frac{L}{A}`, desc: "Resistance" },
        { id: "24.7", formula: `P=IV`, desc: "Electric Power" }
    ],
    "Ch.25: DC Circuits": [
        { id: "25.1", formula: `R_{ser} = R_1 + R_2 + ...`, desc: "Series Resistors" },
        { id: "25.3a", formula: `\\frac{1}{R_{par}} = \\frac{1}{R_1} + \\frac{1}{R_2} + ...`, desc: "Parallel Resistors" },
        { id: "25.6", formula: `V_C(t) = \\mathcal{E}(1 - e^{-t/RC})`, desc: "Charging RC Circuit" }
    ],
    "Ch.26: Magnetism": [
        { id: "26.1", formula: `\\mathbf{F}_B = q\\mathbf{v} \\times \\mathbf{B}`, desc: "Magnetic Force" },
        { id: "26.5", formula: `\\mathbf{F} = I\\mathbf{L} \\times \\mathbf{B}`, desc: "Force on Current" },
        { id: "26.17", formula: `\\oint \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{enc}`, desc: "Ampère's Law" }
    ],
    "Ch.27: EM Induction": [
        { id: "27.2", formula: `\\mathcal{E} = -\\frac{d\\Phi_B}{dt}`, desc: "Faraday's Law" },
        { id: "27.5", formula: `\\mathcal{E}_L = -L\\frac{dI}{dt}`, desc: "Inductor EMF" },
        { id: "27.9", formula: `U = \\frac{1}{2}LI^2`, desc: "Energy in Inductor" }
    ],
    "Ch.28: AC Circuits": [
        { id: "28.5", formula: `X_C = \\frac{1}{\\omega C}`, desc: "Capacitive Reactance" },
        { id: "28.7", formula: `X_L = \\omega L`, desc: "Inductive Reactance" },
        { id: "28.12", formula: `Z = \\sqrt{R^2 + (X_L - X_C)^2}`, desc: "Impedance" }
    ],
    "Ch.29: EM Waves": [
        { id: "29.16a", formula: `c = \\frac{1}{\\sqrt{\\epsilon_0\\mu_0}}`, desc: "Speed of Light (Vacuum)" },
        { id: "29.17", formula: `E = cB`, desc: "E and B Relation" },
        { id: "29.19b", formula: `\\mathbf{S} = \\frac{1}{\\mu_0}(\\mathbf{E} \\times \\mathbf{B})`, desc: "Poynting Vector" }
    ],
    "Ch.30: Reflection & Refraction": [
        { id: "30.1", formula: `\\theta_1 = \\theta'_1`, desc: "Law of Reflection" },
        { id: "30.3", formula: `n_1 \\sin\\theta_1 = n_2 \\sin\\theta_2`, desc: "Snell's Law" },
        { id: "30.5", formula: `\\sin\\theta_c = \\frac{n_2}{n_1}`, desc: "Critical Angle" }
    ],
    "Ch.31: Lenses & Instruments": [
        { id: "31.2", formula: `\\frac{1}{s} + \\frac{1}{s'} = \\frac{1}{f}`, desc: "Mirror/Lens Equation" },
        { id: "31.7", formula: `\\frac{1}{f} = (n-1)(\\frac{1}{R_1} - \\frac{1}{R_2})`, desc: "Lensmaker's Formula" }
    ],
    "Ch.32: Interference & Diffraction": [
        { id: "32.1a", formula: `d \\sin\\theta = m\\lambda`, desc: "Bright Fringes (Double-Slit)" },
        { id: "32.8", formula: `a \\sin\\theta = m\\lambda`, desc: "Dark Fringes (Single-Slit)" },
        { id: "32.11b", formula: `\\theta_{min} \\approx 1.22\\frac{\\lambda}{D}`, desc: "Rayleigh Criterion" }
    ],
    "Ch.33: Relativity": [
        { id: "33.3", formula: `\\Delta t = \\gamma \\Delta t_0`, desc: "Time Dilation" },
        { id: "33.4", formula: `L = L_0 / \\gamma`, desc: "Length Contraction" },
        { id: "33.9", formula: `E = \\gamma mc^2`, desc: "Total Energy" },
        { id: "33.10", formula: `E^2 = (pc)^2 + (mc^2)^2`, desc: "Energy-Momentum" }
    ],
    "Ch.34: Particles & Waves": [
        { id: "34.6", formula: `E = hf`, desc: "Photon Energy" },
        { id: "34.7", formula: `K_{max} = hf - \\phi`, desc: "Photoelectric Effect" },
        { id: "34.14", formula: `\\lambda = h/p`, desc: "De Broglie Wavelength" },
        { id: "34.15", formula: `\\Delta x \\Delta p \\ge \\frac{\\hbar}{2}`, desc: "Uncertainty Principle" }
    ],
    "Ch.35: Quantum Mechanics": [
        { id: "35.1", formula: `-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi}{dx^2} + U\\psi = E\\psi`, desc: "Schrödinger Eq. (1D)" },
        { id: "35.5", formula: `E_n = \\frac{n^2 h^2}{8mL^2}`, desc: "Energy Levels (Infinite Well)" }
    ],
    "Ch.38: Nuclear Physics": [
        { id: "38.1", formula: `R = R_0 A^{1/3}`, desc: "Nuclear Radius" },
        { id: "38.3a", formula: `N(t) = N_0 e^{-\\lambda t}`, desc: "Radioactive Decay" },
        { id: "38.7", formula: `E_b = (Zm_p + Nm_n - m_{nuc})c^2`, desc: "Binding Energy" }
    ],
    "Ch.39: Cosmology": [
        { id: "39.1", formula: `v = H_0 d`, desc: "Hubble's Law" },
        { id: "39.2", formula: `\\rho_c = \\frac{3H_0^2}{8\\pi G}`, desc: "Critical Density" }
    ]
};
const parts = [
    { id: 0, name: "Introduction", range: "Ch.1", chapters: ["Ch.1: Doing Physics"], class: "p0" },
    { id: 1, name: "Mechanics", range: "Ch.2-12", chapters: [
        "Ch.2: Motion in Straight Line", "Ch.3: Motion in 2D/3D", "Ch.4: Force & Motion",
        "Ch.5: Using Newton's Laws", "Ch.6: Energy, Work, Power", "Ch.7: Conservation of Energy",
        "Ch.8: Gravity", "Ch.9: Systems of Particles", "Ch.10: Rotational Motion",
        "Ch.11: Angular Momentum", "Ch.12: Static Equilibrium"
    ], class: "p1" },
    { id: 2, name: "Waves & Fluids", range: "Ch.13-15", chapters: [
        "Ch.13: Oscillatory Motion", "Ch.14: Wave Motion", "Ch.15: Fluid Motion"
    ], class: "p2" },
    { id: 3, name: "Thermodynamics", range: "Ch.16-19", chapters: [
        "Ch.16: Temperature & Heat", "Ch.17: Thermal Behavior", "Ch.18: First Law of Thermo",
        "Ch.19: Second Law of Thermo"
    ], class: "p3" },
    { id: 4, name: "Electromagnetism", range: "Ch.20-29", chapters: [
        "Ch.20: Electric Fields", "Ch.21: Gauss's Law", "Ch.22: Electric Potential",
        "Ch.23: Capacitors", "Ch.24: Electric Current", "Ch.25: DC Circuits",
        "Ch.26: Magnetism", "Ch.27: EM Induction", "Ch.28: AC Circuits", "Ch.29: EM Waves"
    ], class: "p4" },
    { id: 5, name: "Optics", range: "Ch.30-32", chapters: [
        "Ch.30: Reflection & Refraction", "Ch.31: Lenses & Instruments", "Ch.32: Interference & Diffraction"
    ], class: "p5" },
    { id: 6, name: "Modern Physics", range: "Ch.33-39", chapters: [
        "Ch.33: Relativity", "Ch.34: Particles & Waves", "Ch.35: Quantum Mechanics",
        "Ch.38: Nuclear Physics", "Ch.39: Cosmology"
    ], class: "p6" }
];

const themes = [
    'Default', 'Dark', 'Dracula', 'Nord', 'Gruvbox', 'Synthwave', 'Ocean', 'Solarized', 'Monokai', 'Forest'
];

let searchTimeout = null;

document.addEventListener('DOMContentLoaded', () => {
    renderNavigation();
    renderContent();
    renderThemes();
    setupSearch();
    loadTheme();
    
    setTimeout(() => {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "\\[", right: "\\]", display: true},
                {left: "$", right: "$", display: false}
            ],
            throwOnError: false
        });
    }, 100);
    
    // Open first two parts by default
    document.querySelectorAll('.nav-part')[0]?.classList.add('open');
    document.querySelectorAll('.nav-part')[1]?.classList.add('open');
});

function renderThemes() {
    const menu = document.getElementById('themeMenu');
    let html = '';
    themes.forEach((theme, i) => {
        const cls = i === 0 ? 'active' : '';
        html += `<div class="theme-opt ${cls}" onclick="setTheme('${theme.toLowerCase()}', '${theme}')">${theme}</div>`;
    });
    menu.innerHTML = html;
}

function toggleThemeMenu() {
    document.getElementById('themeMenu').classList.toggle('show');
}

function setTheme(cls, name) {
    document.body.className = cls === 'default' ? '' : cls;
    document.getElementById('currentTheme').textContent = name;
    document.querySelectorAll('.theme-opt').forEach(el => el.classList.remove('active'));
    event.target.classList.add('active');
    localStorage.setItem('physics-theme', cls);
    localStorage.setItem('physics-theme-name', name);
}

function loadTheme() {
    const saved = localStorage.getItem('physics-theme');
    const name = localStorage.getItem('physics-theme-name');
    if (saved) {
        document.body.className = saved === 'default' ? '' : saved;
        document.getElementById('currentTheme').textContent = name || 'Default';
    }
}

function renderNavigation() {
    const nav = document.getElementById('navigation');
    let html = '';
    
    parts.forEach(part => {
        html += `<div class="nav-part" data-part="${part.id}">
            <div class="part-header ${part.class}" onclick="togglePart(${part.id})">
                <span>${part.name} (${part.range})</span>
                <span class="arrow">▸</span>
            </div>
            <div class="part-chapters">`;
        
        part.chapters.forEach(ch => {
            if (FORMULA_DATA[ch]) {
                html += `<div class="chapter-link" data-chapter="${ch}" onclick="scrollToChapter('${ch}')">${ch}</div>`;
            }
        });
        
        html += `</div></div>`;
    });
    
    nav.innerHTML = html;
}

function renderContent() {
    const content = document.getElementById('content');
    let html = '';
    
    Object.keys(FORMULA_DATA).forEach(chapterName => {
        const formulas = FORMULA_DATA[chapterName];
        html += `<div class="chapter-section" id="ch-${chapterName.replace(/[:\s]/g, '-')}">
            <h2 class="chapter-title">${chapterName}</h2>
            <div class="formulas-grid">`;
        
        formulas.forEach(formula => {
            const keywords = `${chapterName.toLowerCase()} ${formula.id.toLowerCase()} ${formula.desc.toLowerCase()}`;
            html += `<div class="formula-card" data-keywords="${keywords}">
                <div class="formula-number">${formula.id}</div>
                <div class="formula-content">\\[${formula.formula}\\]</div>
                <div class="formula-desc">${formula.desc}</div>
            </div>`;
        });
        
        html += `</div></div>`;
    });
    
    content.innerHTML = html;
}

function togglePart(partId) {
    document.querySelector(`.nav-part[data-part="${partId}"]`).classList.toggle('open');
}

function scrollToChapter(chapterName) {
    const chapterId = 'ch-' + chapterName.replace(/[:\s]/g, '-');
    const chapterEl = document.getElementById(chapterId);
    if (chapterEl) {
        chapterEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
        document.querySelectorAll('.chapter-link').forEach(el => el.classList.remove('active'));
        document.querySelector(`.chapter-link[data-chapter="${chapterName}"]`)?.classList.add('active');
        if (window.innerWidth <= 768) {
            document.getElementById('sidebar').classList.remove('open');
        }
    }
}

function setupSearch() {
    const searchInput = document.getElementById('searchInput');
    const searchStatus = document.getElementById('searchStatus');
    
    searchInput.addEventListener('input', () => {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            const query = searchInput.value.toLowerCase().trim();
            const cards = document.querySelectorAll('.formula-card');
            let matchCount = 0;
            
            cards.forEach(card => {
                const keywords = card.dataset.keywords;
                const matches = !query || keywords.includes(query);
                
                if (matches) {
                    card.style.display = '';
                    if (query) {
                        card.classList.add('highlight');
                        matchCount++;
                    } else {
                        card.classList.remove('highlight');
                    }
                } else {
                    card.style.display = 'none';
                    card.classList.remove('highlight');
                }
            });
            
            if (query) {
                searchStatus.textContent = `${matchCount} formula${matchCount !== 1 ? 's' : ''} found`;
            } else {
                searchStatus.textContent = '';
            }
            
            // Show/hide empty chapters
            document.querySelectorAll('.chapter-section').forEach(section => {
                const visibleCards = section.querySelectorAll('.formula-card:not([style*="display: none"])');
                section.style.display = visibleCards.length > 0 ? '' : 'none';
            });
        }, 300);
    });
}

function toggleSidebar() {
    document.getElementById('sidebar').classList.toggle('open');
}

// Update active chapter on scroll
let scrollTimeout = null;
window.addEventListener('scroll', () => {
    clearTimeout(scrollTimeout);
    scrollTimeout = setTimeout(() => {
        const sections = document.querySelectorAll('.chapter-section');
        let currentChapter = null;
        
        sections.forEach(section => {
            const rect = section.getBoundingClientRect();
            if (rect.top <= 150 && rect.bottom >= 150) {
                currentChapter = section.id.replace('ch-', '').replace(/-/g, ' ').replace(/Ch /g, 'Ch.');
            }
        });
        
        if (currentChapter) {
            document.querySelectorAll('.chapter-link').forEach(el => el.classList.remove('active'));
            document.querySelector(`.chapter-link[data-chapter="${currentChapter}"]`)?.classList.add('active');
        }
    }, 100);
});

// Close theme menu when clicking outside
document.addEventListener('click', (e) => {
    const menu = document.getElementById('themeMenu');
    const btn = document.querySelector('.theme-btn');
    if (menu && !menu.contains(e.target) && e.target !== btn && !btn.contains(e.target)) {
        menu.classList.remove('show');
    }
});
</script>
</body>
</html>
